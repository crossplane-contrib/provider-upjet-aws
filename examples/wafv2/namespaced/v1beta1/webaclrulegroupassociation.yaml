# SPDX-FileCopyrightText: 2025 The Crossplane Authors <https://crossplane.io>
#
# SPDX-License-Identifier: CC0-1.0


apiVersion: wafv2.aws.m.upbound.io/v1beta1
kind: WebACLRuleGroupAssociation
metadata:
  annotations:
    meta.upbound.io/example-id: wafv2/v1beta1/webaclrulegroupassociation
  labels:
    testing.upbound.io/example-name: example
  name: example
  namespace: upbound-system
spec:
  forProvider:
    priority: 100
    region: us-west-1
    ruleGroupReference:
    - arnSelector:
        matchLabels:
          testing.upbound.io/example-name: example
    ruleName: example-rule-group-rule
    webAclArnSelector:
      matchLabels:
        testing.upbound.io/example-name: example

---

apiVersion: wafv2.aws.m.upbound.io/v1beta1
kind: RuleGroup
metadata:
  annotations:
    meta.upbound.io/example-id: wafv2/v1beta1/webaclrulegroupassociation
  labels:
    testing.upbound.io/example-name: example
  name: example
  namespace: upbound-system
spec:
  forProvider:
    capacity: 10
    name: example-rule-group
    region: us-west-1
    rule:
    - action:
      - block:
        - {}
      name: block-suspicious-requests
      priority: 1
      statement:
      - geo_match_statement:
        - country_codes:
          - CN
          - RU
      visibility_config:
      - cloudwatch_metrics_enabled: true
        metric_name: block-suspicious-requests
        sampled_requests_enabled: true
    scope: REGIONAL
    visibilityConfig:
      cloudwatchMetricsEnabled: true
      metricName: example-rule-group
      sampledRequestsEnabled: true

---

apiVersion: wafv2.aws.m.upbound.io/v1beta1
kind: WebACL
metadata:
  annotations:
    meta.upbound.io/example-id: wafv2/v1beta1/webaclrulegroupassociation
  labels:
    testing.upbound.io/example-name: example
  name: example
  namespace: upbound-system
spec:
  forProvider:
    defaultAction:
      allow: {}
    name: example-web-acl
    region: us-west-1
    scope: REGIONAL
    visibilityConfig:
      cloudwatchMetricsEnabled: true
      metricName: example-web-acl
      sampledRequestsEnabled: true
