# SPDX-FileCopyrightText: 2025 The Crossplane Authors <https://crossplane.io>
#
# SPDX-License-Identifier: CC0-1.0


apiVersion: verifiedaccess.aws.upbound.io/v1beta1
kind: TrustProvider
metadata:
  annotations:
    meta.upbound.io/example-id: verifiedaccess/v1beta1/trustprovider
  labels:
    testing.upbound.io/example-name: example-trustprovider
  name: example-trustprovider
spec:
  forProvider:
    policyReferenceName: example
    region: us-west-1
    trustProviderType: user
    userTrustProviderType: oidc
    oidcOptions:
      issuer: https://cognito-idp.us-west-1.amazonaws.com/us-west-1_xxxxxxxxx
      authorizationEndpoint: "https://us-west-1xxxxxxxxx.auth.us-west-1.amazoncognito.com/oauth2/authorize"
      tokenEndpoint: "https://us-west-1xxxxxxxxx.auth.us-west-1.amazoncognito.com/oauth2/token"
      userInfoEndpoint: "https://us-west-1xxxxxxxxx.auth.us-west-1.amazoncognito.com/oauth2/userInfo"
      clientId: xxxxxxxxxxxxxxxxxxxxxxxxxx
      clientSecretSecretRef:
        name: example-trustprovider
        namespace: default
        key: clientsecret
      scope: openid email

---

apiVersion: v1
kind: Secret
metadata:
  name: example-trustprovider
  namespace: default
stringData:
  clientsecret: clientsecretvalue

---

apiVersion: verifiedaccess.aws.upbound.io/v1beta1
kind: Instance
metadata:
  annotations:
    meta.upbound.io/example-id: verifiedaccess/v1beta1/instance
  labels:
    testing.upbound.io/example-name: example-trustprovider
  name: example-trustprovider
spec:
  forProvider:
    description: example with trustprovider
    region: us-west-1
    tags:
      Name: example-trustprovider

---

apiVersion: verifiedaccess.aws.upbound.io/v1beta1
kind: InstanceTrustProviderAttachment
metadata:
  annotations:
    meta.upbound.io/example-id: verifiedaccess/v1beta1/instancetrustproviderattachment
  labels:
    testing.upbound.io/example-name: example-trustprovider
  name: example-trustprovider
spec:
  forProvider:
    region: us-west-1
    verifiedaccessInstanceIdSelector:
      matchLabels:
        testing.upbound.io/example-name: example-trustprovider
    verifiedaccessTrustProviderIdSelector:
      matchLabels:
        testing.upbound.io/example-name: example-trustprovider
